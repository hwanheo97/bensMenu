{"ast":null,"code":"var _jsxFileName = \"C:\\\\boilerplate-mern-stack-master\\\\client\\\\src\\\\components\\\\views\\\\CartPage\\\\CartPage.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { getCartItems, removeCartItem, onSuccessBuy } from '../../../_actions/user_actions';\nimport UserCardBlock from './Sections/UserCardBlock';\nimport { Empty, Result } from 'antd';\nimport Paypal from '../../utils/Paypal';\n\nfunction CartPage(props) {\n  const dispatch = useDispatch();\n  const [Total, setTotal] = useState(0);\n  const [ShowTotal, setShowTotal] = useState(false); // true일때만 가격 보여주기,처음에 안보여야 해서 false\n\n  const [ShowSuccess, setShowSuccess] = useState(false);\n  useEffect(() => {\n    let cartItems = []; //redux User state안에 cart안에 상품이 들어있는 지 확인\n\n    if (props.user.userData && props.user.userData.cart) {\n      if (props.user.userData.cart.length > 0) {\n        props.user.userData.cart.forEach(item => {\n          cartItems.push(item.id);\n        });\n        dispatch(getCartItems(cartItems, props.user.userData.cart)).then(response => {\n          calculateTotal(response.payload);\n        }); //console.log('CartPage' , response)) \n      }\n    }\n  }, [props.user.userData]);\n\n  let calculateTotal = cartDetail => {\n    let total = 0; //Objects, {} in JavaScript does not have the method .map(). It's only for Arrays, [].\n    //→ 오브젝트는 map()함수를 가지고있지 않아 사용할 수가 없다. 배열만 가능하다.\n    //→ data.map()으로 썻으면 data.product.map()으로 코드를 바꿔라 왜냐면 product가 배열이니깐 잘 반복될거야\n\n    cartDetail.map(item => {\n      total += parseInt(item.price, 10) * item.quantity;\n    });\n    setTotal(total);\n    setShowTotal(true);\n  };\n\n  let removeFromCart = productId => {\n    //2) redux action =removeCartItem  => user_actions.js의 export function removeCartItem\n    dispatch(removeCartItem(productId)).then(response => {\n      //console.log('remove버튼 response',response)\n      if (response.payload.productInfo.length <= 0) {\n        setShowTotal(false);\n      }\n    });\n  };\n\n  const transactionSuccess = data => {\n    dispatch(onSuccessBuy({\n      paymentData: data,\n      cartDetail: props.user.cartDetail\n    })).then(response => {\n      if (response.payload.success) {\n        setShowTotal(false);\n        setShowSuccess(true);\n      }\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: '85%',\n      margin: '3rem auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }, \"My Cart \"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(UserCardBlock, {\n    products: props.user.cartDetail,\n    removeItem: removeFromCart,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 11\n    }\n  })), ShowTotal ? /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      marginTop: '3rem'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }\n  }, \"Total Amount : $\", Total)) : ShowSuccess ? /*#__PURE__*/React.createElement(Result, {\n    status: \"success\",\n    title: \"Successfully Purchased Items\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 14\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Empty, {\n    description: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }\n  })), ShowTotal && /*#__PURE__*/React.createElement(Paypal, {\n    total: Total,\n    onSuccess: transactionSuccess,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 14\n    }\n  }));\n}\n\nexport default CartPage;","map":{"version":3,"sources":["C:/boilerplate-mern-stack-master/client/src/components/views/CartPage/CartPage.js"],"names":["React","useEffect","useState","useDispatch","getCartItems","removeCartItem","onSuccessBuy","UserCardBlock","Empty","Result","Paypal","CartPage","props","dispatch","Total","setTotal","ShowTotal","setShowTotal","ShowSuccess","setShowSuccess","cartItems","user","userData","cart","length","forEach","item","push","id","then","response","calculateTotal","payload","cartDetail","total","map","parseInt","price","quantity","removeFromCart","productId","productInfo","transactionSuccess","data","paymentData","success","width","margin","marginTop"],"mappings":"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","sourcesContent":["import React, {useEffect, useState } from 'react'\r\nimport {useDispatch} from 'react-redux';\r\nimport {getCartItems, removeCartItem, onSuccessBuy} from '../../../_actions/user_actions';\r\nimport UserCardBlock from './Sections/UserCardBlock';\r\nimport { Empty,Result } from 'antd';\r\nimport Paypal from '../../utils/Paypal';\r\n\r\n\r\n\r\nfunction CartPage(props) {\r\n \r\n  const dispatch = useDispatch();\r\n\r\n  const [Total,setTotal] =useState(0)\r\n  const [ShowTotal,setShowTotal] = useState(false) \r\n  // true일때만 가격 보여주기,처음에 안보여야 해서 false\r\n  const [ShowSuccess,setShowSuccess] = useState(false)\r\n\r\n  useEffect(() =>{\r\n   \r\n    let cartItems = []\r\n\r\n    //redux User state안에 cart안에 상품이 들어있는 지 확인\r\n    if(props.user.userData && props.user.userData.cart){\r\n        if(props.user.userData.cart.length > 0){\r\n          props.user.userData.cart.forEach(item => {\r\n              cartItems.push(item.id)\r\n          })\r\n          dispatch(getCartItems(cartItems, props.user.userData.cart))\r\n             .then(response =>  {calculateTotal(response.payload)})  //console.log('CartPage' , response)) \r\n       }\r\n    }\r\n  },[props.user.userData])\r\n\r\n  let calculateTotal =(cartDetail) =>{\r\n    let total =0;\r\n//Objects, {} in JavaScript does not have the method .map(). It's only for Arrays, [].\r\n//→ 오브젝트는 map()함수를 가지고있지 않아 사용할 수가 없다. 배열만 가능하다.\r\n//→ data.map()으로 썻으면 data.product.map()으로 코드를 바꿔라 왜냐면 product가 배열이니깐 잘 반복될거야\r\n\r\n    cartDetail.map(item => {\r\n      total += parseInt(item.price, 10) * item.quantity\r\n    })\r\n    setTotal(total)\r\n    setShowTotal(true)\r\n  }\r\n\r\n  let removeFromCart = (productId) => {\r\n    //2) redux action =removeCartItem  => user_actions.js의 export function removeCartItem\r\n    dispatch(removeCartItem(productId))\r\n    .then(response =>{\r\n      //console.log('remove버튼 response',response)\r\n      if(response.payload.productInfo.length <=0){\r\n        setShowTotal(false)\r\n\r\n      }\r\n\r\n    })\r\n  }\r\n    const transactionSuccess = (data) => {\r\n      dispatch(onSuccessBuy({       \r\n         paymentData : data,     \r\n        cartDetail : props.user.cartDetail    \r\n\r\n      }))\r\n        .then(response => {\r\n        if(response.payload.success){\r\n          setShowTotal(false)    \r\n          setShowSuccess(true)   \r\n        }\r\n      })\r\n    }\r\n\r\n  return (\r\n    <div style={{width:'85%', margin:'3rem auto'}}>\r\n        <h1>My Cart </h1>\r\n        <div>\r\n          <UserCardBlock products={props.user.cartDetail} removeItem={removeFromCart}/>\r\n          {/* //3)redux 간단하게 product.js수정경우 products={props.user.cartDetail  && props.user.cartDetail.product}중 && props.user.cartDetail.product 없애도 됨 */}\r\n        </div>\r\n\r\n        {ShowTotal ?\r\n            <div style={{marginTop:'3rem'}}>\r\n            <h2>Total Amount : ${Total}</h2>\r\n          </div>\r\n          : ShowSuccess ?\r\n             <Result\r\n              status=\"success\"\r\n              title=\"Successfully Purchased Items\"\r\n            />\r\n          :\r\n          <>\r\n          <br/>\r\n          <br/>\r\n            <Empty description={false}/>\r\n            <br/>\r\n          </>\r\n         \r\n      }\r\n           {/* <p style={{textAlign:'center' ,color:'red'}}>카트에 선택하신 상품이 없습니다</p> */}\r\n            {ShowTotal && \r\n             <Paypal \r\n             total = {Total}\r\n             onSuccess={transactionSuccess}\r\n             />\r\n            \r\n            }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CartPage\r\n"]},"metadata":{},"sourceType":"module"}